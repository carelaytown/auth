
<style>
#libraryelderly-app table {
  border-collapse: collapse;
  width: 100%;
  font-size: 0.9rem;
}
#libraryelderly-app th, #libraryelderly-app td {
  border: 1px solid #ccc;
  padding: 6px 8px;
  text-align: left;
}
#libraryelderly-app th {
  background-color: #f8f8f8;
}
#libraryelderly-app td:nth-child(1) { width: 40px; text-align: center; }
#libraryelderly-app td:nth-child(2) { min-width: 160px; max-width: 200px; }
#libraryelderly-app td:nth-child(3) { min-width: 120px; max-width: 140px; }
#libraryelderly-app td:nth-child(4),
#libraryelderly-app td:nth-child(5),
#libraryelderly-app td:nth-child(6) { min-width: 110px; max-width: 130px; word-break: break-word; }
#libraryelderly-app td:nth-child(7) { min-width: 200px; max-width: 260px; }
#libraryelderly-app td:nth-child(8) { min-width: 130px; max-width: 160px; }
#libraryelderly-app td:nth-child(9) { min-width: 140px; max-width: 180px; }
#libraryelderly-app td:nth-child(10) { min-width: 80px; max-width: 100px; word-break: break-all; }
</style>

<script>
(() => {
  const supabase = window.supabaseClient || window.supabase.createClient(
    "https://viihcgkjzzhkdiwdzdex.supabase.co",
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  );

  window.PREF_TABLE_MAP ??= {
    "北海道": "01_hokkaido", "青森県": "02_aomori", "岩手県": "03_iwate", "宮城県": "04_miyagi",
    "秋田県": "05_akita", "山形県": "06_yamagata", "福島県": "07_fukushima", "茨城県": "08_ibaraki",
    "栃木県": "09_tochigi", "群馬県": "10_gunma", "埼玉県": "11_saitama", "千葉県": "12_chiba",
    "東京都": "13_tokyo", "神奈川県": "14_kanagawa", "新潟県": "15_niigata", "富山県": "16_toyama",
    "石川県": "17_ishikawa", "福井県": "18_fukui", "山梨県": "19_yamanashi", "長野県": "20_nagano",
    "岐阜県": "21_gifu", "静岡県": "22_shizuoka", "愛知県": "23_aichi", "三重県": "24_mie",
    "滋賀県": "25_shiga", "京都府": "26_kyoto", "大阪府": "27_osaka", "兵庫県": "28_hyogo",
    "奈良県": "29_nara", "和歌山県": "30_wakayama", "鳥取県": "31_tottori", "島根県": "32_shimane",
    "岡山県": "33_okayama", "広島県": "34_hiroshima", "山口県": "35_yamaguchi", "徳島県": "36_tokushima",
    "香川県": "37_kagawa", "愛媛県": "38_ehime", "高知県": "39_kochi", "福岡県": "40_fukuoka",
    "佐賀県": "41_saga", "長崎県": "42_nagasaki", "熊本県": "43_kumamoto", "大分県": "44_oita",
    "宮崎県": "45_miyazaki", "鹿児島県": "46_kagoshima", "沖縄県": "47_okinawa"
  };

  async function loadOptions(table) {
    const [{ data: cities }, { data: services }] = await Promise.all([
      supabase.from(table).select("city").not("city", "is", null).neq("city", "").limit(10000),
      supabase.from(table).select("service_type").not("service_type", "is", null).neq("service_type", "").limit(10000)
    ]);
    const citySet = [...new Set((cities || []).map(d => d.city))].sort();
    const serviceSet = [...new Set((services || []).map(d => d.service_type))].sort();
    document.getElementById("citySelect").innerHTML = '<option value="">市区町村</option>' + citySet.map(c => `<option>${c}</option>`).join('');
    document.getElementById("serviceSelect").innerHTML = '<option value="">サービスの種別</option>' + serviceSet.map(s => `<option>${s}</option>`).join('');
  }
})();
</script>
