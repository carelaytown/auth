<!-- 元のadmin-apps.htmlの全コードはそのまま維持 -->
<!-- 以下は "アプリ追加" ボタンなどの後に追記してください -->

<div style="display: inline-block; margin-left: 20px;">
  カテゴリ：
  <select id="category-filter">
    <option value="all">すべて</option>
  </select>
</div>

<script>
  const supabaseUrl = 'https://udcrfwejohzmhfojnwha.supabase.co';
  const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzIiwicmVmIjoidWRjcmZ3ZWpvaHptaGZvam53aGEiLCJyb2xlIjoiYW5vbiIsImlhdCI6MTc0NTk4OTU3OCwiZXhwIjoyMDYxNTY1NTc4fQ.dqy_L8iPlbUDoozkha4yjar4ADvinxGc0a6ygSuBLQI';
  const supabase = supabase.createClient(supabaseUrl, supabaseKey);

  async function loadCategoryOptions() {
    const { data, error } = await supabase.from('apps').select('category');
    if (error) {
      console.error('カテゴリの取得エラー:', error.message);
      return;
    }
    const categories = [...new Set(data.map(row => row.category).filter(Boolean))];
    const select = document.getElementById('category-filter');
    categories.forEach(cat => {
      const option = document.createElement('option');
      option.value = cat;
      option.textContent = cat;
      select.appendChild(option);
    });
  }

  document.getElementById('category-filter').addEventListener('change', function () {
    const selected = this.value;
    const table = document.querySelector('table');
    const rows = table.querySelectorAll('tbody tr');
    rows.forEach(row => {
      const categoryCell = row.cells[3];
      const category = categoryCell?.querySelector('input')?.value || '';
      const match = selected === 'all' || category === selected;
      row.style.display = match ? '' : 'none';
    });
  });

  window.addEventListener('DOMContentLoaded', async () => {
    await loadCategoryOptions();
  });
</script>
